
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exercises (2.16 - 2.47) &#8212; Linear Programming Chapter</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/Exercises/Exercises_2';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="References and Suggested Readings" href="../References/References.html" />
    <link rel="prev" title="Exercises (2.1 - 2.15)" href="Exercises_1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Linear Programming Chapter</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Linear Programming
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_2/2_2.html">2.2 The Art and Skill of Problem Formulation</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_3/2_3_1.html">2.3 Graphical Solution of Linear Programming Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_3/2_3_2.html">2.3.2 Graphical Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_3/2_3_3.html">2.3.3 Multiple Optimal Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_3/2_3_4.html">2.3.4 No Optimal Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_3/2_3_5.html">2.3.5 No Feasible Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_3/2_3_6.html">2.3.6 General Solution Method</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_4/2_4_1.html">2.4 Preparation for the Simplex Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_4/2_4_2.html">2.4.2 Solutions of Linear Systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_5/2_5.html">2.5 The Simplex Method</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_6/2_6_1.html">2.6 Initial Solutions for General Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_6/2_6_2.html">2.6.2 The Two Phase Method</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_7/2_7.html">2.7 Information in the Tableau</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_7/2_7_1.html">2.7.1 Multiple Optimal Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_7/2_7_2.html">2.7.2 Unbounded Solution (No Optimal Solution)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_7/2_7_3.html">2.7.3 Degenerate Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_7/2_7_4.html">2.7.4 Analyzing the Optimal Tableau: Shadow Prices</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_8/2_8.html">2.8 Duality and Sensitivity Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_8/2_8_1.html">2.8.1 The Dual Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_8/2_8_2.html">2.8.2 Postoptimality and Sensitivity Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_9/2_9.html">2.9 Revised Simplex and Computational Efficiency</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.10</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_10/2_10.html">2.10 Software for Linear Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_10/2_10_1.html">2.10.1 Extensions to General Simplex Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_10/2_10_2.html">2.10.2 Interior Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_10/2_10_3.html">2.10.3 Software for Solving Linear Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.11</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_11/2_11_1.html">2.11 Illustrative Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_11/2_11_2.html">2.11.2 Aircraft and Munitions Procurement (Might 1987)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_11/2_11_3.html">2.11.3 Grape Processing: Materials Planning and Production (Schuster and Allen 1998)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Section 2.12</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_12/2_12.html">2.12 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Exercises_1.html">Exercises (2.1 - 2.15)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exercises (2.16 - 2.47)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References and Suggested Readings</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../References/References.html">References and Suggested Readings</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/MohammadBaniAbdElNabi/Linear-programming/main?urlpath=tree/content/Exercises/Exercises_2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/Exercises/Exercises_2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercises (2.16 - 2.47)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercises-2-16-2-47">
<h1>Exercises (2.16 - 2.47)<a class="headerlink" href="#exercises-2-16-2-47" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/drive/1BJO1Zz-lLUnRx2RZiec9tAB9VrjB6cdU?usp=sharing"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p><strong>2.16</strong></p>
<ul />
<p>Use the Simplex algorithm to solve the linear programming formulation from Exercise 2.1. What is the percentage utilization of the disk and printer resources at optimality? Comment on how the university community is likely to react to the optimal solution to this problem.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Coefficients of the objective function (maximize income)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Negative because linprog does minimization</span>

<span class="c1"># Coefficients of the inequality constraints</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>  <span class="c1"># Disk space constraint</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>   <span class="c1"># Printer time constraint</span>
<span class="p">]</span>

<span class="c1"># Right-hand side of the inequality constraints</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>

<span class="c1"># Bounds for the decision variables (number of student and faculty jobs)</span>
<span class="n">x0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Solve the linear programming problem using the Highs solver</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x0_bounds</span><span class="p">,</span> <span class="n">x1_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Optimal number of student and faculty jobs</span>
<span class="n">num_student_jobs</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">num_faculty_jobs</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calculate the percentage utilization of disk and printer resources</span>
<span class="n">disk_utilization</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">num_student_jobs</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">num_faculty_jobs</span><span class="p">)</span> <span class="o">/</span> <span class="mi">48</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">printer_utilization</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">num_student_jobs</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">num_faculty_jobs</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal number of student jobs: </span><span class="si">{</span><span class="n">num_student_jobs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal number of faculty jobs: </span><span class="si">{</span><span class="n">num_faculty_jobs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Percentage utilization of disk resources: </span><span class="si">{</span><span class="n">disk_utilization</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Percentage utilization of printer resources: </span><span class="si">{</span><span class="n">printer_utilization</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal number of student jobs: 8.0
Optimal number of faculty jobs: 0.0
Percentage utilization of disk resources: 100.0%
Percentage utilization of printer resources: 40.0%
</pre></div>
</div>
</div>
</div>
<p><strong>2.17</strong></p>
<ul />
<p>Solve the following problem using the Simplex method:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; z = x_1 + 2x_2 \\
\text{subject to} \quad &amp; x_1 + x_2 \geq 6 \\  
&amp; x_2 \leq 6 \\
&amp; x_1 \leq 8 \\
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Coefficients of the objective function (maximize Z = X1 + 2X2)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Negative because linprog does minimization</span>

<span class="c1"># Coefficients of the inequality constraints</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># x1 + x2 &gt;= 6 -&gt; -x1 - x2 &lt;= -6</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>    <span class="c1"># x2 &lt;= 6</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>     <span class="c1"># x1 &lt;= 8</span>
<span class="p">]</span>

<span class="c1"># Right-hand side of the inequality constraints</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>

<span class="c1"># Bounds for the decision variables (X1 and X2)</span>
<span class="n">x0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Solve the linear programming problem using the Highs solver</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x0_bounds</span><span class="p">,</span> <span class="n">x1_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Optimal values of X1 and X2</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Optimal value of Z</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">X1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">X2</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of X1: </span><span class="si">{</span><span class="n">X1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of X2: </span><span class="si">{</span><span class="n">X2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of Z: </span><span class="si">{</span><span class="n">Z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal value of X1: 8.0
Optimal value of X2: 6.0
Optimal value of Z: 20.0
</pre></div>
</div>
</div>
</div>
<p><strong>2.18</strong></p>
<ul />
<p>Solve the following problem using the Simplex method:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; z = 4x_1 + 1x_2 \\
\text{subject to} \quad &amp; 3x_1 + x_2 = 3 \\  
&amp; 4x_1 + 3x_2 \geq 6 \\
&amp; x_1 + 2x_2 \leq 3 \\
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Coefficients of the objective function (maximize z = 4x1 + x2)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Negative because linprog does minimization</span>

<span class="c1"># Coefficients of the inequality constraints</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>  <span class="c1"># 4x1 + 3x2 &gt;= 6 -&gt; -4x1 - 3x2 &lt;= -6</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>     <span class="c1"># x1 + 2x2 &lt;= 3</span>
<span class="p">]</span>

<span class="c1"># Right-hand side of the inequality constraints</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># Coefficients of the equality constraint</span>
<span class="n">A_eq</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>     <span class="c1"># 3x1 + x2 = 3</span>
<span class="p">]</span>

<span class="c1"># Right-hand side of the equality constraint</span>
<span class="n">b_eq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># Bounds for the decision variables (X1 and X2)</span>
<span class="n">x0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Solve the linear programming problem using the Highs solver</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x0_bounds</span><span class="p">,</span> <span class="n">x1_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Optimal values of X1 and X2</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Optimal value of Z</span>
<span class="n">Z</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">+</span> <span class="n">X2</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of X1: </span><span class="si">{</span><span class="n">X1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of X2: </span><span class="si">{</span><span class="n">X2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of Z: </span><span class="si">{</span><span class="n">Z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal value of X1: 0.6
Optimal value of X2: 1.2
Optimal value of Z: 3.5999999999999996
</pre></div>
</div>
</div>
</div>
<p><strong>2.19</strong></p>
<ul />
<p>Apply the Simplex algorithm to each of the following problems. Observe the behavior of the Simplex method and indicate which problems display degeneracy, multiple optima, infeasibility, or an unbounded solution.</p>
<ul />
<p><strong>a.</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; 3x_1 + x_2 \\
\text{subject to} \quad &amp; x_1 \leq 8 \\  
&amp; 2x_1 - 3x_2 \leq 5 \\
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
<p><strong>b.</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; 3x_1 + 4x_2 \\
\text{subject to} \quad &amp; x_1 + x_2 \geq 5 \\  
&amp; 2x_1 + 1x_2 \leq 4 \\
&amp; 2x_1 + 1x_2 \leq 4 \\
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
<p><strong>c.</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; x_1 + 2x_2 \\
\text{subject to} \quad &amp; x_1 + 2x_2 \leq 10 \\  
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
<p><strong>d.</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; 3x_1 + 9x_2 \\
\text{subject to} \quad &amp; x_1 + 4x_2 \leq 8 \\  
&amp; x_1 + 2x_2 \leq 8 \\
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
</ul>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Define a function to solve the linear programming problem</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_lp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Bounds for the decision variables (X1 and X2)</span>
    <span class="n">x0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Solve the linear programming problem using the Highs solver</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x0_bounds</span><span class="p">,</span> <span class="n">x1_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

    <span class="c1"># Check if the solution is valid</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="c1"># Optimal values of X1 and X2</span>
        <span class="n">X1</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">X2</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Optimal value of Z</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="o">-</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span>  <span class="c1"># Negate because we minimized the negative of the objective function</span>

        <span class="k">return</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Z</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="c1"># Problem (a)</span>
<span class="n">c_a</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A_a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">b_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">X1_a</span><span class="p">,</span> <span class="n">X2_a</span><span class="p">,</span> <span class="n">Z_a</span> <span class="o">=</span> <span class="n">solve_lp</span><span class="p">(</span><span class="n">c_a</span><span class="p">,</span> <span class="n">A_a</span><span class="p">,</span> <span class="n">b_a</span><span class="p">)</span>

<span class="c1"># Problem (b)</span>
<span class="n">c_b</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]</span>
<span class="n">A_b</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">b_b</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">X1_b</span><span class="p">,</span> <span class="n">X2_b</span><span class="p">,</span> <span class="n">Z_b</span> <span class="o">=</span> <span class="n">solve_lp</span><span class="p">(</span><span class="n">c_b</span><span class="p">,</span> <span class="n">A_b</span><span class="p">,</span> <span class="n">b_b</span><span class="p">)</span>

<span class="c1"># Problem (c)</span>
<span class="n">c_c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">A_c</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">b_c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">X1_c</span><span class="p">,</span> <span class="n">X2_c</span><span class="p">,</span> <span class="n">Z_c</span> <span class="o">=</span> <span class="n">solve_lp</span><span class="p">(</span><span class="n">c_c</span><span class="p">,</span> <span class="n">A_c</span><span class="p">,</span> <span class="n">b_c</span><span class="p">)</span>

<span class="c1"># Problem (d)</span>
<span class="n">c_d</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">]</span>
<span class="n">A_d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">b_d</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">X1_d</span><span class="p">,</span> <span class="n">X2_d</span><span class="p">,</span> <span class="n">Z_d</span> <span class="o">=</span> <span class="n">solve_lp</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">A_d</span><span class="p">,</span> <span class="n">b_d</span><span class="p">)</span>

<span class="c1"># Print the results for all problems</span>
<span class="k">if</span> <span class="n">X1_a</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Problem (a): No feasible solution&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Problem (a): Optimal value of X1: </span><span class="si">{</span><span class="n">X1_a</span><span class="si">}</span><span class="s2">, Optimal value of X2: </span><span class="si">{</span><span class="n">X2_a</span><span class="si">}</span><span class="s2">, Optimal value of Z: </span><span class="si">{</span><span class="n">Z_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">X1_b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Problem (b): No feasible solution&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Problem (b): Optimal value of X1: </span><span class="si">{</span><span class="n">X1_b</span><span class="si">}</span><span class="s2">, Optimal value of X2: </span><span class="si">{</span><span class="n">X2_b</span><span class="si">}</span><span class="s2">, Optimal value of Z: </span><span class="si">{</span><span class="n">Z_b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">X1_c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Problem (c): No feasible solution&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Problem (c): Optimal value of X1: </span><span class="si">{</span><span class="n">X1_c</span><span class="si">}</span><span class="s2">, Optimal value of X2: </span><span class="si">{</span><span class="n">X2_c</span><span class="si">}</span><span class="s2">, Optimal value of Z: </span><span class="si">{</span><span class="n">Z_c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">X1_d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Problem (d): No feasible solution&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Problem (d): Optimal value of X1: </span><span class="si">{</span><span class="n">X1_d</span><span class="si">}</span><span class="s2">, Optimal value of X2: </span><span class="si">{</span><span class="n">X2_d</span><span class="si">}</span><span class="s2">, Optimal value of Z: </span><span class="si">{</span><span class="n">Z_d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Problem (a): No feasible solution
Problem (b): No feasible solution
Problem (c): Optimal value of X1: 10.0, Optimal value of X2: 0.0, Optimal value of Z: 10.0
Problem (d): Optimal value of X1: 8.0, Optimal value of X2: 0.0, Optimal value of Z: 24.0
</pre></div>
</div>
</div>
</div>
<p><strong>2.20</strong></p>
<ul />
<p>Create a linear programming problem formulation that has unbounded solutions but in which no evidence of unboundedness appears in the initial Simplex tableau.</p>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximize z = x1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subject to:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -x1 + x2 &lt;= 1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1 - 2x2 &lt;= 2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1, x2 &gt;= 0&quot;</span><span class="p">)</span>

<span class="c1"># Objective coefficients(for variables x1, x2)</span>
<span class="n">c_linprog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> 

<span class="c1"># Inequality constraints (Ax &lt;= b)</span>
<span class="c1"># -x1 + x2 &lt;= 1</span>
<span class="c1">#  x1 - 2x2 &lt;= 2</span>
<span class="n">A_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">b_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># Bounds for x1, x2 (x_i &gt;= 0 is default, but explicit is clear)</span>
<span class="n">x0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># x1 &gt;= 0</span>
<span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># x2 &gt;= 0</span>


<span class="c1"># Solve the LP</span>
<span class="c1"># Using &#39;highs&#39; method as it&#39;s robust and handles unboundedness well.</span>
<span class="c1"># Older scipy versions might default to &#39;interior-point&#39; or &#39;simplex&#39; which also detect unboundedness.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_linprog</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_ub</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x0_bounds</span><span class="p">,</span> <span class="n">x1_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Solver message, crucial for unboundedness</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values of x1, x2 at termination: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Values of decision variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximize z = x1
Subject to:
  -x1 + x2 &lt;= 1
   x1 - 2x2 &lt;= 2
   x1, x2 &gt;= 0
Message: The problem is unbounded. (HiGHS Status 10: model_status is Unbounded; primal_status is Feasible)
Values of x1, x2 at termination: None
</pre></div>
</div>
</div>
</div>
<p><strong>2.21</strong></p>
<ul />
<p>Perform as many Simplex iterations as possible on the example problem in Section 2.7.2. Observe that the algorithm terminates when there are no ratios <span class="math notranslate nohighlight">\(θ_i\)</span> from which to choose a variable to leave the basis.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SimplexSolver</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="p">):</span>
        <span class="c1"># Convert inputs to NumPy arrays</span>
        <span class="n">A_ub_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A_ub</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">b_ub_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_ub</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">c_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span> <span class="o">=</span> <span class="n">A_ub_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span> <span class="o">=</span> <span class="n">A_ub_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_total_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span>

        <span class="c1"># Create tableau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_total_vars</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Objective function row (z - c*x = 0  =&gt; z - c1*x1 - c2*x2 ... = 0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># z coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_np</span> <span class="c1"># -c_j for decision variables</span>

        <span class="c1"># Constraint rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A_ub_np</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_total_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b_ub_np</span> <span class="c1"># RHS</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="p">)]</span> <span class="o">+</span> \
                         <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;s</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">)]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">basis_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_total_vars</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_indices</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_tableau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Basis&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;RHS&#39;</span><span class="p">]</span>
        
        <span class="n">basis_col_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Basis&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Basis&#39;</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">basis_col_width</span><span class="si">}}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;z&#39;</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="s2"> | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&gt;7</span><span class="si">}</span><span class="s2"> | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;RHS&#39;</span><span class="si">:</span><span class="s2">&gt;7</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">basis_col_width</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">7</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;z&#39;</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">basis_col_width</span><span class="si">}}</span><span class="s2"> | </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;5.2f</span><span class="si">}</span><span class="s2"> | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">&gt;7.2f</span><span class="si">}</span><span class="s2"> | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;7.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">):</span>
            <span class="n">basis_var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basis_var_name</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">basis_col_width</span><span class="si">}}</span><span class="s2"> | </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;5.2f</span><span class="si">}</span><span class="s2"> | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">&gt;7.2f</span><span class="si">}</span><span class="s2"> | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;7.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">basis_col_width</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">7</span><span class="p">))</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">select_entering_variable_col_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">z_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
        <span class="n">most_negative_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z_row</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">most_negative_val</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">1e-9</span><span class="p">:</span> <span class="c1"># Allow for small positive due to precision</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> 
        <span class="n">entering_col_tableau_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">z_row</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> 
        <span class="k">return</span> <span class="n">entering_col_tableau_idx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">select_leaving_variable_row_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entering_col_idx</span><span class="p">):</span>
        <span class="n">min_ratio</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="n">leaving_row_tableau_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="n">constraint_coeffs_entering_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">entering_col_idx</span><span class="p">]</span>
        <span class="n">rhs_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ratios for leaving variable:&quot;</span><span class="p">)</span>
        <span class="n">all_coeffs_non_positive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">found_positive_coeff</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">):</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="n">constraint_coeffs_entering_var</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">rhs</span> <span class="o">=</span> <span class="n">rhs_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">var_name_in_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">coeff</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span> 
                <span class="n">all_coeffs_non_positive</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">found_positive_coeff</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># Ensure RHS is non-negative for standard ratio test, though it should be.</span>
                <span class="c1"># If RHS is 0 and coeff is positive, ratio is 0.</span>
                <span class="k">if</span> <span class="n">rhs</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1e-9</span> <span class="p">:</span> <span class="c1"># If RHS is significantly negative, this row is not a candidate.</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Row </span><span class="si">{</span><span class="n">var_name_in_basis</span><span class="si">}</span><span class="s2">: RHS=</span><span class="si">{</span><span class="n">rhs</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Coeff=</span><span class="si">{</span><span class="n">coeff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Ratio=N/A (RHS &lt; 0)&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">ratio</span> <span class="o">=</span> <span class="n">rhs</span> <span class="o">/</span> <span class="n">coeff</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Row </span><span class="si">{</span><span class="n">var_name_in_basis</span><span class="si">}</span><span class="s2">: RHS=</span><span class="si">{</span><span class="n">rhs</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Coeff=</span><span class="si">{</span><span class="n">coeff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Ratio=</span><span class="si">{</span><span class="n">ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="n">min_ratio</span><span class="p">:</span>
                    <span class="n">min_ratio</span> <span class="o">=</span> <span class="n">ratio</span>
                    <span class="n">leaving_row_tableau_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Row </span><span class="si">{</span><span class="n">var_name_in_basis</span><span class="si">}</span><span class="s2">: RHS=</span><span class="si">{</span><span class="n">rhs</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Coeff=</span><span class="si">{</span><span class="n">coeff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Ratio=N/A (coeff &lt;= 0)&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">all_coeffs_non_positive</span> <span class="ow">and</span> <span class="n">found_positive_coeff</span> <span class="o">==</span> <span class="kc">False</span> <span class="p">:</span> <span class="c1"># Corrected logic: if no positive coeffs found at all</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All coefficients in entering column are non-positive. Problem is unbounded.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> 
            
        <span class="k">if</span> <span class="n">leaving_row_tableau_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">found_positive_coeff</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No suitable leaving variable found (e.g., all valid ratios might be for negative RHS or issues with Bland&#39;s rule for degeneracy not implemented).&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">3</span> 
        <span class="k">elif</span> <span class="n">leaving_row_tableau_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">found_positive_coeff</span><span class="p">:</span> <span class="c1"># Should be caught by all_coeffs_non_positive</span>
             <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All coefficients in entering column are non-positive. Problem is unbounded. (Fallback check)&quot;</span><span class="p">)</span>
             <span class="k">return</span> <span class="o">-</span><span class="mi">2</span>

        <span class="k">if</span> <span class="n">leaving_row_tableau_idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min ratio is </span><span class="si">{</span><span class="n">min_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">[</span><span class="n">leaving_row_tableau_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> leaves.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">leaving_row_tableau_idx</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pivot_row_idx</span><span class="p">,</span> <span class="n">pivot_col_idx</span><span class="p">):</span>
        <span class="n">pivot_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">pivot_row_idx</span><span class="p">,</span> <span class="n">pivot_col_idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pivot_element</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-9</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Pivot element is too close to zero (</span><span class="si">{</span><span class="n">pivot_element</span><span class="si">}</span><span class="s2">). Halting.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pivoting on element at (tableau row </span><span class="si">{</span><span class="n">pivot_row_idx</span><span class="si">}</span><span class="s2">, tableau col </span><span class="si">{</span><span class="n">pivot_col_idx</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">pivot_element</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">pivot_row_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">pivot_element</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">pivot_row_idx</span><span class="p">:</span>
                <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">pivot_col_idx</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="n">factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">pivot_row_idx</span><span class="p">,</span> <span class="p">:]</span>
        
        <span class="n">leaving_var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">[</span><span class="n">pivot_row_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">entering_var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">[</span><span class="n">pivot_col_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">[</span><span class="n">pivot_row_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">entering_var_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis_indices</span><span class="p">[</span><span class="n">pivot_row_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pivot_col_idx</span><span class="o">-</span><span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variable </span><span class="si">{</span><span class="n">entering_var_name</span><span class="si">}</span><span class="s2"> entered basis, </span><span class="si">{</span><span class="n">leaving_var_name</span><span class="si">}</span><span class="s2"> left.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_tableau</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="n">entering_col_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_entering_variable_col_idx</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">entering_col_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Optimal solution found.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_tableau</span><span class="p">(</span><span class="n">iteration</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
                <span class="n">solution</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">}</span>
                <span class="n">obj_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">basis_var_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">):</span>
                    <span class="c1"># Correctly round values for final solution display</span>
                    <span class="n">val_to_store</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val_to_store</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-9</span> <span class="p">:</span> <span class="n">val_to_store</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># Snap near-zero to zero</span>
                    <span class="n">solution</span><span class="p">[</span><span class="n">basis_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">val_to_store</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal z = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">obj_value</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="c1"># Print only variables with non-zero values for clarity</span>
                <span class="n">final_solution_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">solution</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1e-9</span> <span class="ow">or</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution values: </span><span class="si">{</span><span class="n">final_solution_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;Optimal&quot;</span>

            <span class="n">entering_var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">[</span><span class="n">entering_col_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entering variable: </span><span class="si">{</span><span class="n">entering_var_name</span><span class="si">}</span><span class="s2"> (tableau column </span><span class="si">{</span><span class="n">entering_col_idx</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="n">leaving_row_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_leaving_variable_row_idx</span><span class="p">(</span><span class="n">entering_col_idx</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">leaving_row_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Problem is UNBOUNDED.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_tableau</span><span class="p">(</span><span class="n">iteration</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
                <span class="k">return</span> <span class="s2">&quot;Unbounded&quot;</span>
            <span class="k">if</span> <span class="n">leaving_row_idx</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cannot proceed: Error in selecting leaving variable or other issue.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_tableau</span><span class="p">(</span><span class="n">iteration</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;Error&quot;</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">leaving_row_idx</span><span class="p">,</span> <span class="n">entering_col_idx</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;Error: Pivot Failed&quot;</span> <span class="c1"># Added return if pivot fails</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">print_tableau</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Maximum iterations reached.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;Max Iterations&quot;</span>


<span class="c1"># --- Problem Definition from Section 2.7.2 ---</span>
<span class="n">c_obj</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>      <span class="c1"># Objective function coefficients for x1, x2</span>
<span class="c1"># Ensure A and b are Python lists as in the user&#39;s error context</span>
<span class="n">A_constraints</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>   <span class="c1"># Coefficients for constraint 1</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]]</span>   <span class="c1"># Coefficients for constraint 2</span>
<span class="n">b_constraints</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>     <span class="c1"># RHS for constraints</span>

<span class="c1"># The SimplexSolver class handles conversion to NumPy arrays internally.</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">SimplexSolver</span><span class="p">(</span><span class="n">c_obj</span><span class="p">,</span> <span class="n">A_constraints</span><span class="p">,</span> <span class="n">b_constraints</span><span class="p">)</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final Status: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Iteration 0 ---
Basis |     z |      x1 |      x2 |      s1 |      s2 |     RHS
-------------------------------------------------------------
z     |  1.00 |   -5.00 |   -6.00 |    0.00 |    0.00 |    0.00
s1    |  0.00 |   -1.00 |    1.00 |    1.00 |    0.00 |    2.00
s2    |  0.00 |    0.00 |    1.00 |    0.00 |    1.00 |   10.00
-------------------------------------------------------------
Entering variable: x2 (tableau column 2)
Ratios for leaving variable:
  Row s1: RHS=2.00, Coeff=1.00, Ratio=2.00
  Row s2: RHS=10.00, Coeff=1.00, Ratio=10.00
Min ratio is 2.00, s1 leaves.
Pivoting on element at (tableau row 1, tableau col 2) = 1.00
Variable x2 entered basis, s1 left.

--- Iteration 1 ---
Basis |     z |      x1 |      x2 |      s1 |      s2 |     RHS
-------------------------------------------------------------
z     |  1.00 |  -11.00 |    0.00 |    6.00 |    0.00 |   12.00
x2    |  0.00 |   -1.00 |    1.00 |    1.00 |    0.00 |    2.00
s2    |  0.00 |    1.00 |    0.00 |   -1.00 |    1.00 |    8.00
-------------------------------------------------------------
Entering variable: x1 (tableau column 1)
Ratios for leaving variable:
  Row x2: RHS=2.00, Coeff=-1.00, Ratio=N/A (coeff &lt;= 0)
  Row s2: RHS=8.00, Coeff=1.00, Ratio=8.00
Min ratio is 8.00, s2 leaves.
Pivoting on element at (tableau row 2, tableau col 1) = 1.00
Variable x1 entered basis, s2 left.

--- Iteration 2 ---
Basis |     z |      x1 |      x2 |      s1 |      s2 |     RHS
-------------------------------------------------------------
z     |  1.00 |    0.00 |    0.00 |   -5.00 |   11.00 |  100.00
x2    |  0.00 |    0.00 |    1.00 |    0.00 |    1.00 |   10.00
x1    |  0.00 |    1.00 |    0.00 |   -1.00 |    1.00 |    8.00
-------------------------------------------------------------
Entering variable: s1 (tableau column 3)
Ratios for leaving variable:
  Row x2: RHS=10.00, Coeff=0.00, Ratio=N/A (coeff &lt;= 0)
  Row x1: RHS=8.00, Coeff=-1.00, Ratio=N/A (coeff &lt;= 0)
All coefficients in entering column are non-positive. Problem is unbounded.

Problem is UNBOUNDED.

--- Iteration 2 ---
Basis |     z |      x1 |      x2 |      s1 |      s2 |     RHS
-------------------------------------------------------------
z     |  1.00 |    0.00 |    0.00 |   -5.00 |   11.00 |  100.00
x2    |  0.00 |    0.00 |    1.00 |    0.00 |    1.00 |   10.00
x1    |  0.00 |    1.00 |    0.00 |   -1.00 |    1.00 |    8.00
-------------------------------------------------------------

Final Status: Unbounded
</pre></div>
</div>
</div>
</div>
<p><strong>2.22</strong></p>
<ul />
<p>Solve the following linear programming problem using the Two Phase Simplex method.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; z = 4x_1 + x_2 \\
\text{subject to} \quad &amp; 3x_1 + x_2 = 3 \\  
&amp; 4x_1 + 3x_2 \geq 6 \\
&amp; x_1 + 2x_2 \leq 3 \\
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Phase 1: Minimize w = a1 (remove artificial variable)</span>
<span class="n">c_phase1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Objective function for phase 1 (w = a1)</span>
<span class="n">A_eq_phase1</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># 3x1 + x2 = 3</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># 4x1 + 3x2 - s1 + a1 = 6</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>    <span class="c1"># x1 + 2x2 + s2 = 3</span>
<span class="p">]</span>
<span class="n">b_eq_phase1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># Solve Phase 1</span>
<span class="n">res_phase1</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">c_phase1</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq_phase1</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq_phase1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">res_phase1</span><span class="o">.</span><span class="n">success</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">res_phase1</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Phase 1 successful: Feasible solution found.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Phase 1 failed: No feasible solution.&quot;</span><span class="p">)</span>
    <span class="n">exit</span><span class="p">()</span>

<span class="c1"># Phase 2: Maximize original objective function z = 4x1 + x2</span>
<span class="n">c_phase2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Maximize z (convert to minimization problem)</span>
<span class="n">A_eq_phase2</span> <span class="o">=</span> <span class="n">A_eq_phase1</span>
<span class="n">b_eq_phase2</span> <span class="o">=</span> <span class="n">b_eq_phase1</span>

<span class="c1"># Solve Phase 2</span>
<span class="n">res_phase2</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">c_phase2</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq_phase2</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq_phase2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">res_phase2</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal solution found:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x1 = </span><span class="si">{</span><span class="n">res_phase2</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, x2 = </span><span class="si">{</span><span class="n">res_phase2</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum z = </span><span class="si">{</span><span class="o">-</span><span class="n">res_phase2</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimization failed in Phase 2.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Phase 1 successful: Feasible solution found.
Optimal solution found:
x1 = 1.00, x2 = 0.00
Maximum z = 4.00
</pre></div>
</div>
</div>
</div>
<p><strong>2.23</strong></p>
<ul />
<p>Examine this linear programming formulation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; z = x_1 + 2x_2 \\
\text{subject to} \quad &amp; x_1 + 2x_2 \leq 10 \\  
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
<p>Comment on the nature of its solution(s). How does this change if the first constraint is removed from the problem?</p>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Define a function to solve the linear programming problem</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_lp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
    <span class="c1"># Solve the linear programming problem using the Highs solver</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

    <span class="c1"># Check if the solution is valid</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="c1"># Optimal values of X1 and X2</span>
        <span class="n">X1</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">X2</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Optimal value of Z</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="o">-</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span>  <span class="c1"># Negate because we minimized the negative of the objective function</span>

        <span class="k">return</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Z</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="c1"># Problem with the first constraint</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">solve_lp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>

<span class="k">if</span> <span class="n">X1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Problem with the first constraint: No feasible solution&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Problem with the first constraint: Optimal value of X1: </span><span class="si">{</span><span class="n">X1</span><span class="si">}</span><span class="s2">, Optimal value of X2: </span><span class="si">{</span><span class="n">X2</span><span class="si">}</span><span class="s2">, Optimal value of Z: </span><span class="si">{</span><span class="n">Z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Problem without the first constraint</span>
<span class="n">A_no_constraint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">b_no_constraint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">X1_no_constraint</span><span class="p">,</span> <span class="n">X2_no_constraint</span><span class="p">,</span> <span class="n">Z_no_constraint</span> <span class="o">=</span> <span class="n">solve_lp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_no_constraint</span><span class="p">,</span> <span class="n">b_no_constraint</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>

<span class="k">if</span> <span class="n">X1_no_constraint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Problem without the first constraint: No feasible solution&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Problem without the first constraint: Optimal value of X1: </span><span class="si">{</span><span class="n">X1_no_constraint</span><span class="si">}</span><span class="s2">, Optimal value of X2: </span><span class="si">{</span><span class="n">X2_no_constraint</span><span class="si">}</span><span class="s2">, Optimal value of Z: </span><span class="si">{</span><span class="n">Z_no_constraint</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Problem with the first constraint: Optimal value of X1: 10.0, Optimal value of X2: 0.0, Optimal value of Z: 10.0
Problem without the first constraint: No feasible solution
</pre></div>
</div>
</div>
</div>
<p><strong>2.24</strong></p>
<ul />
<p>Solve the following linear programming problem graphically.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; z = x_1 - x_2 \\
\text{subject to} \quad &amp; x_1 + x_2 \geq 1 \\  
&amp; 3x_2 \geq 9 \\
&amp; 2x_1 + x_2 \leq 4 \\
&amp; 3x_1 \leq 1.5 \\
&amp;  x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line2</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Parallel lines, no intersection</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_feasible</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span>  <span class="c1"># Ensure non-negative solutions</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_feasible_points</span><span class="p">(</span><span class="n">constraints</span><span class="p">):</span>
    <span class="n">feasible_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">intersection</span> <span class="o">=</span> <span class="n">find_intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">intersection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_feasible</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
            <span class="n">feasible_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">feasible_points</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_feasible_region</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">)</span>
    <span class="n">feasible_region</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
            <span class="n">feasible_region</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
            <span class="n">feasible_region</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">feasible_region</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
               <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_constraints</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x_vals</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y_vals</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">x + </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">y </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_and_plot</span><span class="p">():</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>    <span class="c1"># x1 + x2 &gt;= 1</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>    <span class="c1"># 3x2 &gt;= 9</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">),</span>    <span class="c1"># 2x1 + x2 &lt;= 4</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">),</span>  <span class="c1"># 3x1 &lt;= 1.5</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>    <span class="c1"># x1 &gt;= 0</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>     <span class="c1"># x2 &gt;= 0</span>
    <span class="p">]</span>

    <span class="n">obj_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span>  <span class="c1"># z = x1 - x2</span>

    <span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="n">plot_feasible_region</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">)</span>
    <span class="n">plot_constraints</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">)</span>

    <span class="n">feasible_points</span> <span class="o">=</span> <span class="n">find_feasible_points</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">feasible_points</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">feasible_x</span><span class="p">,</span> <span class="n">feasible_y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">feasible_points</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">feasible_x</span><span class="p">,</span> <span class="n">feasible_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Feasible Points&#39;</span><span class="p">)</span>

        <span class="c1"># Compute objective function values at extreme points</span>
        <span class="n">obj_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj_func</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_points</span><span class="p">]</span>

        <span class="c1"># Display best extreme point</span>
        <span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">obj_values</span><span class="p">)</span>
        <span class="n">optimal_point</span> <span class="o">=</span> <span class="n">feasible_points</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">optimal_point</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimal Point&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Optimal Solution:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal Point: (</span><span class="si">{</span><span class="n">optimal_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">optimal_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum z = </span><span class="si">{</span><span class="n">obj_values</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feasible Region and Optimal Solution&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">solve_and_plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Solution:
Optimal Point: (0.50, 3.00)
Maximum z = -2.50
</pre></div>
</div>
<img alt="../../_images/474bf1e72e0040325b49bae83291f2758373eeb85946a1eb7b36c3303faf85a4.png" src="../../_images/474bf1e72e0040325b49bae83291f2758373eeb85946a1eb7b36c3303faf85a4.png" />
</div>
</div>
<p><strong>2.25</strong></p>
<ul />
<p>What determines the number of basic variables in a linear programming problem solution?</p>
<p><strong>Solution:</strong></p>
<p>The number of basic variables in a linear programming problem solution is determined by the number of constraints in the system. Specifically, in a system with ( m ) constraints and ( n ) decision variables, a basic feasible solution will have exactly ( m ) basic variables and ( n-m ) non-basic variables.</p>
</ul>
<p><strong>2.26</strong></p>
<ul />
<p>What is the value of a non-basic variable in a feasible solution of a linear programming problem?</p>
<p><strong>Solution:</strong></p>
<p>In a feasible solution of a linear programming problem, a non-basic variable is assigned a value of zero. This allows the remaining basic variables to be solved uniquely from the system of equations.</p>
</ul>
<p><strong>2.27</strong></p>
<ul />
<p>In an optimal Simplex tableau, what is the economic interpretation of the objective function row entry corresponding to the i-th slack variable?</p>
<p><strong>Solution:</strong></p>
<p>In an optimal Simplex tableau, the entry in the objective function row corresponding to the i-th slack variable represents the shadow price of the associated constraint. This value indicates how much the objective function will change per unit increase in the right-hand side of that constraint.</p>
</ul>
<p><strong>2.28</strong></p>
<ul />
<p>In a Simplex tableau, what is the interpretation of the entries in the right-hand-side column?</p>
<p><strong>Solution:</strong></p>
<p>The entries in the right-hand-side column of a Simplex tableau represent the values of the basic variables at the current iteration. These values indicate the current feasible solution for the linear programming problem.</p>
</ul><p><strong>2.29</strong></p>
<ul />
<p>What is the consequence of a tie for the entering basic variable?</p>
<p><strong>Solution:</strong></p>
<p>If there is a tie for the entering basic variable, any of the tied variables can be chosen as the entering variable. This may lead to different pivot sequences, and in some cases, may affect the number of iterations required to reach the optimal solution.</p>
</ul><p><strong>2.30</strong></p>
<ul />
<p>What if there is a tie for the leaving basic variable?</p>
<p><strong>Solution:</strong></p>
<p>If there is a tie for the leaving basic variable, the problem exhibits degeneracy. This can result in cycling, where the Simplex method revisits the same solution repeatedly without progress. Anti-cycling rules, such as Bland’s Rule, can be used to prevent this issue.</p>
</ul><p><strong>2.31</strong></p>
<ul />
<p>What if, in the objective function row of a final tableau, there is a zero in a column corresponding to a non-basic variable?</p>
<p><strong>Solution:</strong></p>
<p>If there is a zero in the objective function row for a non-basic variable in the final tableau, this indicates the presence of multiple optimal solutions. Any increase in the corresponding variable will not change the optimal objective value, allowing for an alternative optimal solution.</p>
</ul><p><strong>2.32</strong></p>
<ul />
<p>What happens in the Simplex algorithm if you choose, as the entering variable,a variable with a negative objective row coefficient but not the most negative coefficient?</p>
<p><strong>Solution:</strong></p>
<p>If a variable with a negative objective row coefficient is chosen as the entering variable but it is not the most negative, the algorithm may still reach the optimal solution but may take more iterations. The standard approach is to choose the most negative coefficient to ensure the fastest path to optimization.</p>
</ul><p><strong>2.33</strong></p>
<ul />
<p>Solve the following problem using the Simplex method:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; z = x_1 + 9x_2 + x_3 \\
\text{subject to} \quad &amp; x_1 + 2x_2 + 3x_3 \leq 9 \\  
&amp; 3x_1 + 2x_2 + 2x_3 \leq 15 \\
&amp; x_1, x_2, x_3 \geq 0 
\end{align*}
\end{split}\]</div>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Coefficients of the objective function (we negate the values for maximization)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Maximizing z = x1 + 9x2 + x3</span>

<span class="c1"># Coefficients of the constraints</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  <span class="c1"># x1 + 2x2 + 3x3 &lt;= 9</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>   <span class="c1"># 3x1 + 2x2 + 2x3 &lt;= 15</span>
<span class="p">]</span>

<span class="c1"># Right-hand side of the constraints</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>

<span class="c1"># Bounds for the variables (x1, x2, x3 &gt;= 0)</span>
<span class="n">x_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x3_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Use linprog to solve the problem (Simplex method)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x_bounds</span><span class="p">,</span> <span class="n">x2_bounds</span><span class="p">,</span> <span class="n">x3_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Display the results</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">x1_opt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x2_opt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x3_opt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">max_z</span> <span class="o">=</span> <span class="o">-</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span>  <span class="c1"># Negate the result to get the maximized value</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of x1: </span><span class="si">{</span><span class="n">x1_opt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of x2: </span><span class="si">{</span><span class="n">x2_opt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value of x3: </span><span class="si">{</span><span class="n">x3_opt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum value of z: </span><span class="si">{</span><span class="n">max_z</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimization failed.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal value of x1: 0.00
Optimal value of x2: 4.50
Optimal value of x3: 0.00
Maximum value of z: 40.50
</pre></div>
</div>
</div>
</div>
<p><strong>2.34</strong></p>
<ul />
<p>Use the Two Phase Simplex method to solve the following problem:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{minimize} \quad &amp; z = 16x_1 + 2x_2 - 3x_3 \\
\text{subject to} \quad &amp; x_1 - 6x_2 \geq 4 \\  
&amp; 3x_2 + 7x_3 \leq -5 \\
&amp; x_1 + x_2 + x_3 = 10 \\
&amp; x_1, x_2, x_3 \geq 0 
\end{align*}
\end{split}\]</div>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LP Formulation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimize z = 16x1 + 2x2 - 3x3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subject to:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1 - 6x2 &gt;= 4&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   3x2 + 7x3 &lt;= -5&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1 + x2 + x3 = 10&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1, x2, x3 &gt;= 0&quot;</span><span class="p">)</span>

<span class="c1"># --- Setup for scipy.optimize ---</span>

<span class="c1"># 1. Objective function (already a minimization problem)</span>
<span class="c1"># Coefficients for x1, x2, x3:</span>
<span class="n">c_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># 2. Inequality constraints (A_ub @ x &lt;= b_ub)</span>
<span class="c1"># The first constraint x1 - 6x2 &gt;= 4 must be converted to &#39;&lt;=&#39; form by multiplying by -1.</span>
<span class="c1"># -x1 + 6x2 &lt;= -4</span>
<span class="c1"># The second constraint 3x2 + 7x3 &lt;= -5 is already in the correct form.</span>
<span class="n">A_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">b_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>

<span class="c1"># 3. Equality constraints (A_eq @ x == b_eq)</span>
<span class="c1"># x1 + x2 + x3 = 10</span>
<span class="n">A_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">b_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">])</span>

<span class="c1"># 4. Bounds for variables (x_i &gt;= 0)</span>
<span class="n">x_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span> <span class="c1"># (x1_min, x1_max), (x2_min, x2_max), ...</span>

<span class="c1"># Solve the LP using the &#39;highs&#39; method, which is robust for these types of problems.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_obj</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_ub</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">x_bounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># --- Cleaned Up Output and Interpretation ---</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Solver Message: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Interpretation based on the solver&#39;s output for an infeasible problem</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span> <span class="ow">and</span> <span class="s2">&quot;infeasible&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conclusion: The LP problem is INFEASIBLE, as verified by the solver.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;             This means no solution exists that satisfies all the constraints.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conclusion: The solver did not report infeasibility as expected.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Solver Status Code: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Success Flag: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LP Formulation:
Minimize z = 16x1 + 2x2 - 3x3
Subject to:
   x1 - 6x2 &gt;= 4
   3x2 + 7x3 &lt;= -5
   x1 + x2 + x3 = 10
   x1, x2, x3 &gt;= 0

Solver Message: The problem is infeasible. (HiGHS Status 8: model_status is Infeasible; primal_status is None)
Conclusion: The LP problem is INFEASIBLE, as verified by the solver.
             This means no solution exists that satisfies all the constraints.
</pre></div>
</div>
</div>
</div>
<p><strong>2.35</strong></p>
<ul />
<p>business executive has the option of investing money in two plans. Plan A guarantees that each dollar invested will earn 70 cents a year hence, and plan B guarantees that each dollar invested will earn $2 two years hence. Plan A allows yearly investments, while in plan B, only investments for periods that are multiples of two years are allowed. How should the executive invest $100,000 to maximize the earnings at the end of three years? Formulate this problem as a linear programming problem.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Coefficients for the objective function (maximize Z = 2.1x1 + 2x2)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># We multiply by -1 because linprog minimizes the objective function</span>

<span class="c1"># Coefficients for the constraints (x1 + x2 = 100000)</span>
<span class="n">A_eq</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>  <span class="c1"># x1 + x2 = 100000</span>
<span class="n">b_eq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100000</span><span class="p">]</span>

<span class="c1"># Bounds for x1 and x2 (both must be &gt;= 0)</span>
<span class="n">x_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Use linprog to solve the problem</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x_bounds</span><span class="p">,</span> <span class="n">x2_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Display the results</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">x1_opt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x2_opt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">max_earnings</span> <span class="o">=</span> <span class="o">-</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span>  <span class="c1"># We negate the result because we minimized it</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal amount to invest in Plan A (x1): $</span><span class="si">{</span><span class="n">x1_opt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal amount to invest in Plan B (x2): $</span><span class="si">{</span><span class="n">x2_opt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum earnings at the end of 3 years: $</span><span class="si">{</span><span class="n">max_earnings</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimization failed.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal amount to invest in Plan A (x1): $100000.00
Optimal amount to invest in Plan B (x2): $0.00
Maximum earnings at the end of 3 years: $210000.00
</pre></div>
</div>
</div>
</div>
<p><strong>2.36</strong></p>
<ul />
<p>An investment portfolio management firm wishes to develop a mathematical model to help decide how to invest $1 million for one year. Municipal bonds are to be bought in combinations that balance risk and profit. Three types of bonds are being considered:</p>
<ul />
<p>• AAA rated bonds yielding 6% annually and which must be purchased in units of $5000.<br>
• A rated bonds yielding 8% annually and which must be purchased in units of $1000.<br>
• J rated (junk) bonds yielding 10% annually and which must be purchased in units of $10,000.<br></p>
</ul>
<p>The Board of Directors has specified that no more than 25% of the portfolio should be invested in (risky) junk bonds, and at least 40% should be invested in AAA rated bonds. Bonds are to be purchased with the objective of maximizing earnings at the end of the year. It may be assumed that the stated yield dividend is paid at the end of the year, and that no other distributions are made during the year. Formulate this problem as a linear programming problem</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Coefficients of the objective function (note the negative signs for maximization)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">]</span>

<span class="c1"># Coefficients of the inequality constraints</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>  <span class="c1"># 5000x1 + 1000x2 + 10000x3 &lt;= 1,000,000</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>            <span class="c1"># x3 &lt;= 25</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>            <span class="c1"># -x1 &lt;= -80 (x1 &gt;= 80)</span>
<span class="p">]</span>

<span class="c1"># Right-hand side of the inequality constraints</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000000</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">]</span>

<span class="c1"># Bounds for each variable</span>
<span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x3_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1_bounds</span><span class="p">,</span> <span class="n">x2_bounds</span><span class="p">,</span> <span class="n">x3_bounds</span><span class="p">]</span>

<span class="c1"># Solve the linear programming problem</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value (Z): </span><span class="si">{</span><span class="o">-</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal solution (x1, x2, x3): </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No solution found.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal value (Z): 77000.0
Optimal solution (x1, x2, x3): [ 80. 350.  25.]
</pre></div>
</div>
</div>
</div>
<p><strong>2.37</strong></p>
<ul />
<p>A philanthropist wishes to develop a mathematical model to help him decide how to donate his spare cash to several worthy causes. He has $10 million to distribute among the recipients, and he would like to donate in units of thousands of dollars. <br>
Three organizations would like to receive funds: Our Great State University, the Friends of the Grand Opera, and the Save the Humuhumunukunukuapua‘a Society. The philanthropist wants to give at most 50% of his cash to any one organization. The desirability of the philanthropist’s giving to any particular recipient is to be measured in terms of the number of tax credits he will receive. The value of giving to an educational institution is rated at 10 credits for every $1000 donation, while the value of $1000 donation to the music lovers is rated at 8 credits, and each $1000 donation to the wildlife conservation is rated at 6 credits. Write a linear programming model to help this philanthropist maximize the number of tax credits that can be achieved by contributing among these three groups.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># Coefficients of the objective function (note the negative signs for maximization)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">]</span>

<span class="c1"># Coefficients of the inequality constraints</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>      <span class="c1"># x1 + x2 + x3 &lt;= 10,000</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>      <span class="c1"># x1 &lt;= 5,000</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>      <span class="c1"># x2 &lt;= 5,000</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>       <span class="c1"># x3 &lt;= 5,000</span>
<span class="p">]</span>

<span class="c1"># Right-hand side of the inequality constraints</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>

<span class="c1"># Bounds for each variable</span>
<span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">x3_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1_bounds</span><span class="p">,</span> <span class="n">x2_bounds</span><span class="p">,</span> <span class="n">x3_bounds</span><span class="p">]</span>

<span class="c1"># Solve the linear programming problem</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal value (Z): </span><span class="si">{</span><span class="o">-</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal solution (x1, x2, x3): </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No solution found.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal value (Z): 90000.0
Optimal solution (x1, x2, x3): [5000. 5000.   -0.]
</pre></div>
</div>
</div>
</div>
<p><strong>2.38</strong></p>
<ul />
<p>Solve the following problem graphically:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{maximize} \quad &amp; z = -2x_1 + x_2 \\
\text{subject to} \quad &amp; x_1 - x_2 \leq 5 \\  
&amp; x_1 \leq 7 \\
&amp; x_2 \leq 6 \\
&amp; x_1 - x_2 \leq -4 \\
&amp; x_1, x_2 \geq 0
\end{align*}
\end{split}\]</div>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line2</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Parallel lines, no intersection</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_feasible</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span>  <span class="c1"># Ensure non-negative solutions</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_feasible_points</span><span class="p">(</span><span class="n">constraints</span><span class="p">):</span>
    <span class="n">feasible_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">intersection</span> <span class="o">=</span> <span class="n">find_intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">intersection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_feasible</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
            <span class="n">feasible_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">feasible_points</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_feasible_region</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">)</span>
    <span class="n">feasible_region</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
            <span class="n">feasible_region</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
            <span class="n">feasible_region</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">feasible_region</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
               <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_constraints</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x_vals</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y_vals</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">x + </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">y </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_and_plot</span><span class="p">():</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">),</span>    <span class="c1"># x1 - x2 &lt;= 5</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">),</span>   <span class="c1"># x1 &lt;= 7</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">),</span>   <span class="c1"># x2 &lt;= 6</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>   <span class="c1"># x1 - x2 &gt;= -4</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>    <span class="c1"># x1 &gt;= 0</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>     <span class="c1"># x2 &gt;= 0</span>
    <span class="p">]</span>

    <span class="n">obj_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span>  <span class="c1"># z = -2x1 + x2</span>

    <span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="n">plot_feasible_region</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">)</span>
    <span class="n">plot_constraints</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">x_range</span><span class="p">)</span>

    <span class="n">feasible_points</span> <span class="o">=</span> <span class="n">find_feasible_points</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">feasible_points</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">feasible_x</span><span class="p">,</span> <span class="n">feasible_y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">feasible_points</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">feasible_x</span><span class="p">,</span> <span class="n">feasible_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Feasible Points&#39;</span><span class="p">)</span>

        <span class="c1"># Compute objective function values at extreme points</span>
        <span class="n">obj_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj_func</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_points</span><span class="p">]</span>

        <span class="c1"># Display best extreme point</span>
        <span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">obj_values</span><span class="p">)</span>
        <span class="n">optimal_point</span> <span class="o">=</span> <span class="n">feasible_points</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">optimal_point</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimal Point&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Optimal Solution:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal Point: (</span><span class="si">{</span><span class="n">optimal_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">optimal_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum z = </span><span class="si">{</span><span class="n">obj_values</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feasible Region and Optimal Solution&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">solve_and_plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Solution:
Optimal Point: (0.00, 4.00)
Maximum z = 4.00
</pre></div>
</div>
<img alt="../../_images/9f8b18c35ac6c0bc357e5b3064e04884879d067cf844c955128ff5fc64375259.png" src="../../_images/9f8b18c35ac6c0bc357e5b3064e04884879d067cf844c955128ff5fc64375259.png" />
</div>
</div>
<p><strong>2.39</strong></p>
<ul />
<p>Write the dual of the primal linear programming problem in Exercise 2.7.</p>
</ul>
<p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_dual_lp</span><span class="p">(</span><span class="n">primal_problem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the dual of a given primal linear programming problem.</span>
<span class="sd">    Assumes a maximization primal and non-negative variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        primal_problem (dict): A dictionary representing the primal LP.</span>
<span class="sd">            Keys: &#39;type&#39; (&#39;maximize&#39;), &#39;c&#39; (objective coeffs), </span>
<span class="sd">                  &#39;constraints&#39; (list of constraint dicts).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary representing the dual LP.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">primal_problem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;maximize&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;maximize&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This function assumes a maximization primal problem.&quot;</span><span class="p">)</span>

    <span class="c1"># --- Step 1: Convert primal to canonical form (all constraints &lt;=) ---</span>
    <span class="n">canonical_primal</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">primal_problem</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">constr</span> <span class="ow">in</span> <span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">:</span>
            <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]]</span>
            <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span>
            <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;=&#39;</span>
        <span class="k">elif</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">:</span>
            <span class="c1"># This would require splitting into two constraints, but not needed for this problem.</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Equality constraints are not handled in this simplified script.&quot;</span><span class="p">)</span>
    
    <span class="c1"># --- Step 2: Extract A, b, c from the canonical primal ---</span>
    <span class="c1"># Objective coefficients of primal become RHS of dual</span>
    <span class="n">dual_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="c1"># RHS of primal constraints become objective coefficients of dual</span>
    <span class="n">dual_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Constraint matrix of primal is transposed for dual</span>
    <span class="n">primal_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dual_A</span> <span class="o">=</span> <span class="n">primal_A</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># --- Step 3: Assemble the dual problem ---</span>
    <span class="n">num_dual_vars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dual_c</span><span class="p">)</span>
    <span class="n">num_dual_constraints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dual_b</span><span class="p">)</span>

    <span class="n">dual_problem</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;minimize&#39;</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">dual_c</span><span class="p">),</span>
        <span class="s1">&#39;var_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;y</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dual_vars</span><span class="p">)],</span>
        <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dual_constraints</span><span class="p">):</span>
        <span class="n">dual_problem</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">dual_A</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="c1"># Dual of max-primal with non-negative vars has &gt;= constraints</span>
            <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="n">dual_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">dual_problem</span>

<span class="k">def</span><span class="w"> </span><span class="nf">print_lp</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Linear Programming Problem&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Neatly prints an LP problem defined in a dictionary.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    
    <span class="n">var_names</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;var_names&#39;</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">problem</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))])</span>
    
    <span class="c1"># Print Objective</span>
    <span class="n">obj_terms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">problem</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span> <span class="c1"># Only show non-zero terms</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">coeff</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span>
            <span class="n">abs_coeff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
            <span class="c1"># Hide coefficient if it&#39;s 1, unless it&#39;s the first term</span>
            <span class="n">coeff_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">abs_coeff</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_coeff</span><span class="si">}</span><span class="s2"> &quot;</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_terms</span><span class="p">:</span> <span class="c1"># First term</span>
                 <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                 <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">obj_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term_str</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">problem</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> w = &quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">obj_terms</span><span class="p">))</span>

    <span class="c1"># Print Constraints</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subject to:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">constr</span> <span class="ow">in</span> <span class="n">problem</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]:</span>
        <span class="n">constr_terms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span> <span class="c1"># Only show non-zero terms</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">coeff</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span>
                <span class="n">abs_coeff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
                <span class="n">coeff_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">abs_coeff</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_coeff</span><span class="si">}</span><span class="s2"> &quot;</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">constr_terms</span><span class="p">:</span>
                    <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">constr_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term_str</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">constr_terms</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Print variable constraints</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span><span class="si">}</span><span class="s2"> &gt;= 0&quot;</span><span class="p">)</span>


<span class="c1"># --- Define the Primal Problem from Exercise 2.7 ---</span>
<span class="c1"># Maximize z = x1 - x2</span>
<span class="c1"># Subject to:</span>
<span class="c1">#   x1 + x2 &gt;= 1</span>
<span class="c1">#   3x2 &lt;= 9</span>
<span class="c1">#   2x1 + x2 &lt;= 4</span>
<span class="c1">#   x1 &lt;= 3/2  (or 1.5)</span>

<span class="n">primal_problem_ex2_7</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;maximize&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="s1">&#39;var_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># --- Generate and Print the Dual ---</span>
<span class="n">dual_problem_ex2_7</span> <span class="o">=</span> <span class="n">get_dual_lp</span><span class="p">(</span><span class="n">primal_problem_ex2_7</span><span class="p">)</span>

<span class="n">print_lp</span><span class="p">(</span><span class="n">primal_problem_ex2_7</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Primal Problem (Exercise 2.7)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">print_lp</span><span class="p">(</span><span class="n">dual_problem_ex2_7</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dual Problem&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Primal Problem (Exercise 2.7) ---
Maximize w = x1 - x2
Subject to:
  x1 + x2 &gt;= 1
  3 x2 &lt;= 9
  2 x1 + x2 &lt;= 4
  x1 &lt;= 1.5
  x1, x2 &gt;= 0


--- Dual Problem ---
Minimize w = -y1 + 9.0 y2 + 4.0 y3 + 1.5 y4
Subject to:
  -y1 + 2.0 y3 + y4 &gt;= 1.0
  -y1 + 3.0 y2 + y3 &gt;= -1.0
  y1, y2, y3, y4 &gt;= 0
</pre></div>
</div>
</div>
</div>
<p><strong>2.40</strong></p>
<ul />
<p>Write the dual of the primal problem in Exercise 2.8. Solve the dual problem, and identify the shadow prices.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_dual_lp</span><span class="p">(</span><span class="n">primal_problem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the dual of a given primal linear programming problem.</span>
<span class="sd">    Assumes a maximization primal and non-negative variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">primal_problem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;maximize&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;maximize&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This function assumes a maximization primal problem.&quot;</span><span class="p">)</span>

    <span class="n">canonical_primal</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">primal_problem</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">constr</span> <span class="ow">in</span> <span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">:</span>
            <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]]</span>
            <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span>
            <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;=&#39;</span>
    
    <span class="n">dual_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dual_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">primal_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">canonical_primal</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dual_A</span> <span class="o">=</span> <span class="n">primal_A</span><span class="o">.</span><span class="n">T</span>

    <span class="n">num_dual_vars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dual_c</span><span class="p">)</span>
    <span class="n">dual_problem</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;minimize&#39;</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">dual_c</span><span class="p">),</span>
        <span class="s1">&#39;var_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;y</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dual_vars</span><span class="p">)],</span>
        <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dual_b</span><span class="p">)):</span>
        <span class="n">dual_problem</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">dual_A</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="n">dual_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="p">})</span>
    <span class="k">return</span> <span class="n">dual_problem</span>

<span class="k">def</span><span class="w"> </span><span class="nf">print_lp</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Linear Programming Problem&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Neatly prints an LP problem defined in a dictionary.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    <span class="n">var_names</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;var_names&#39;</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">problem</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))])</span>
    
    <span class="n">obj_terms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">problem</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">coeff</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span>
            <span class="n">abs_coeff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
            <span class="n">coeff_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">abs_coeff</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_coeff</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_terms</span><span class="p">:</span>
                 <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                 <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">obj_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term_str</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">problem</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> w = &quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">obj_terms</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subject to:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">constr</span> <span class="ow">in</span> <span class="n">problem</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]:</span>
        <span class="n">constr_terms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">coeff</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span>
                <span class="n">abs_coeff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
                <span class="n">coeff_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">abs_coeff</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_coeff</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">constr_terms</span><span class="p">:</span>
                    <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">term_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">coeff_str</span><span class="si">}{</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">constr_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term_str</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">constr_terms</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span><span class="si">}</span><span class="s2"> &gt;= 0&quot;</span><span class="p">)</span>

<span class="c1"># --- Define the Primal Problem from Exercise 2.8 ---</span>
<span class="n">primal_ex2_8</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;maximize&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s1">&#39;var_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;coeffs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;rhs&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># --- 1. Write the Dual ---</span>
<span class="n">dual_problem</span> <span class="o">=</span> <span class="n">get_dual_lp</span><span class="p">(</span><span class="n">primal_ex2_8</span><span class="p">)</span>
<span class="n">print_lp</span><span class="p">(</span><span class="n">primal_ex2_8</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Primal Problem (Exercise 2.8)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">print_lp</span><span class="p">(</span><span class="n">dual_problem</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Generated Dual Problem&quot;</span><span class="p">)</span>

<span class="c1"># --- 2. Solve the Dual Problem using linprog ---</span>
<span class="c1"># The dual objective is &#39;minimize&#39;, which is linprog&#39;s default.</span>
<span class="n">c_dual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dual_problem</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="c1"># linprog requires constraints in &#39;&lt;=&#39; form, so we multiply the dual&#39;s &#39;&gt;=&#39; constraints by -1.</span>
<span class="n">A_dual_gte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">dual_problem</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]])</span>
<span class="n">b_dual_gte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">dual_problem</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]])</span>

<span class="n">A_dual_ub</span> <span class="o">=</span> <span class="o">-</span><span class="n">A_dual_gte</span>
<span class="n">b_dual_ub</span> <span class="o">=</span> <span class="o">-</span><span class="n">b_dual_gte</span>

<span class="c1"># All dual variables y_i &gt;= 0</span>
<span class="n">y_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dual_problem</span><span class="p">[</span><span class="s1">&#39;var_names&#39;</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Solving the Dual Problem ---&quot;</span><span class="p">)</span>
<span class="n">result_dual</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_dual</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_dual_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_dual_ub</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">y_bounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result_dual</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal Value (w) = </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal Values for Dual Variables (y):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">dual_problem</span><span class="p">[</span><span class="s1">&#39;var_names&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">y_val</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dual problem could not be solved successfully.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message: </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 3. Identify the Shadow Prices ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Shadow Prices for the Primal Problem ---&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result_dual</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The shadow prices are the optimal values of the dual variables.&quot;</span><span class="p">)</span>
    <span class="c1"># Map dual variables back to the original primal constraints</span>
    <span class="n">original_constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;x1 - x2 &lt;= 5 &quot;</span><span class="p">,</span>
        <span class="s2">&quot;x1 &lt;= 7      &quot;</span><span class="p">,</span>
        <span class="s2">&quot;x2 &lt;= 6      &quot;</span><span class="p">,</span>
        <span class="s2">&quot;x1 - x2 &gt;= -4&quot;</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">price</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Constraint </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">original_constraints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">): Shadow Price = </span><span class="si">{</span><span class="n">price</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shadow prices cannot be determined as the dual problem did not yield an optimal solution.&quot;</span><span class="p">)</span>

<span class="c1"># --- (Optional) Verification by solving the primal ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Verification: Solving the Primal Problem ---&quot;</span><span class="p">)</span>
<span class="n">c_primal</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">primal_ex2_8</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]]</span> <span class="c1"># Negate for linprog minimization</span>
<span class="n">A_primal_ub_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">b_primal_ub_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">constr</span> <span class="ow">in</span> <span class="n">primal_ex2_8</span><span class="p">[</span><span class="s1">&#39;constraints&#39;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">:</span>
        <span class="n">A_primal_ub_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">])</span>
        <span class="n">b_primal_ub_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">:</span> <span class="c1"># Convert &gt;= to &lt;=</span>
        <span class="n">A_primal_ub_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="o">-</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constr</span><span class="p">[</span><span class="s1">&#39;coeffs&#39;</span><span class="p">]])</span>
        <span class="n">b_primal_ub_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">constr</span><span class="p">[</span><span class="s1">&#39;rhs&#39;</span><span class="p">])</span>
<span class="n">result_primal</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_primal</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_primal_ub_list</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_primal_ub_list</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">)],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result_primal</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">max_z</span> <span class="o">=</span> <span class="o">-</span><span class="n">result_primal</span><span class="o">.</span><span class="n">fun</span> <span class="c1"># We negated the objective, so negate back</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Primal Optimal Value (z) = </span><span class="si">{</span><span class="n">max_z</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dual Optimal Value   (w) = </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">max_z</span><span class="p">,</span> <span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Verification successful: Max z = Min w.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Primal Problem (Exercise 2.8) ---
Maximize w = -2 x1 + x2
Subject to:
  x1 - x2 &lt;= 5
  x1 &lt;= 7
  x2 &lt;= 6
  x1 - x2 &gt;= -4
  x1, x2 &gt;= 0


--- Generated Dual Problem ---
Minimize w = 5.0 y1 + 7.0 y2 + 6.0 y3 + 4.0 y4
Subject to:
  y1 + y2 - y4 &gt;= -2.0
  -y1 + y3 + y4 &gt;= 1.0
  y1, y2, y3, y4 &gt;= 0

--- Solving the Dual Problem ---
Optimal Value (w) = 4.0000
Optimal Values for Dual Variables (y):
  y1 = 0.0000
  y2 = 0.0000
  y3 = 0.0000
  y4 = 1.0000

--- Shadow Prices for the Primal Problem ---
The shadow prices are the optimal values of the dual variables.
  Constraint 1 (x1 - x2 &lt;= 5 ): Shadow Price = 0.0000
  Constraint 2 (x1 &lt;= 7      ): Shadow Price = 0.0000
  Constraint 3 (x2 &lt;= 6      ): Shadow Price = 0.0000
  Constraint 4 (x1 - x2 &gt;= -4): Shadow Price = 1.0000

--- Verification: Solving the Primal Problem ---
Primal Optimal Value (z) = 4.0000
Dual Optimal Value   (w) = 4.0000
Verification successful: Max z = Min w.
</pre></div>
</div>
</div>
</div>
<p><strong>2.41</strong></p>
<ul />
<p>Solve the dual problem corresponding to the primal problem in Exercise 2.12. Determine whether optimal solutions exist. If so, describe the relation between the primal shadow prices and dual variables at optimality.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Solving the Dual of Exercise 2.12 ---&quot;</span><span class="p">)</span>

<span class="c1"># --- Setup for scipy.optimize.linprog ---</span>
<span class="c1"># The dual problem is already a minimization problem.</span>

<span class="c1"># 1. Objective function: Minimize w = 4y1 - 5y2 + 10y3</span>
<span class="c1"># Coefficients for y1, y2, y3:</span>
<span class="n">c_dual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="c1"># 2. Inequality constraints (A_ub @ y &lt;= b_ub)</span>
<span class="c1"># The dual&#39;s &#39;&gt;=&#39;, constraints must be converted to &#39;&lt;=&#39; form by multiplying by -1.</span>
<span class="c1"># y1 + y3 &gt;= 16       =&gt;  -y1 - y3 &lt;= -16</span>
<span class="c1"># -6y1 + 3y2 + y3 &gt;= 2  =&gt;   6y1 - 3y2 - y3 &lt;= -2</span>
<span class="c1"># 7y2 + y3 &gt;= -3      =&gt;  -7y2 - y3 &lt;= 3</span>
<span class="n">A_ub_dual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">b_ub_dual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># 3. Bounds for dual variables</span>
<span class="c1"># y1 &lt;= 0</span>
<span class="c1"># y2 &gt;= 0</span>
<span class="c1"># y3 is unrestricted</span>
<span class="n">y1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">y2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">y3_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">bounds_dual</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1_bounds</span><span class="p">,</span> <span class="n">y2_bounds</span><span class="p">,</span> <span class="n">y3_bounds</span><span class="p">]</span>

<span class="c1"># --- Solve the Dual Problem ---</span>
<span class="n">result_dual</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_dual</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_ub_dual</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_ub_dual</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds_dual</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>


<span class="c1"># --- Analysis of the Results ---</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Solver Message: </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 1. Determine whether optimal solutions exist</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Existence of Optimal Solutions ---&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result_dual</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An optimal solution for the dual problem was found.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal Value (w) = </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal Values for Dual Variables (y):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  y</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">y_val</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="s2">&quot;unbounded&quot;</span> <span class="ow">in</span> <span class="n">result_dual</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No, a finite optimal solution does not exist.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dual problem is UNBOUNDED, meaning its objective function can be decreased to negative infinity.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is the expected outcome, as the primal problem is known to be infeasible.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No, an optimal solution does not exist.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dual problem may be INFEASIBLE or another error occurred.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solver Status Code: </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Solving the Dual of Exercise 2.12 ---

Solver Message: The problem is unbounded. (HiGHS Status 10: model_status is Unbounded; primal_status is Feasible)

--- Existence of Optimal Solutions ---
No, a finite optimal solution does not exist.
The dual problem is UNBOUNDED, meaning its objective function can be decreased to negative infinity.
This is the expected outcome, as the primal problem is known to be infeasible.
</pre></div>
</div>
</div>
</div>
<p><strong>2.42</strong></p>
<ul />
<p>Describe the nature of the solutions of the primal problem in Exercise 2.10 and its dual problem.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="c1"># --- Primal Problem Definition (Exercise 2.10) ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Primal Problem (Exercise 2.10) ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximize z = 3*x1 + 4*x2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subject to:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  6*x1 + 8*x2 &lt;= 10&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1 +  x2 &gt;= 1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1        &gt;= 1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   x1, x2 &gt;= 0&quot;</span><span class="p">)</span>

<span class="c1"># --- 1. Solve the Primal Problem ---</span>
<span class="c1"># To maximize z, we minimize -z.</span>
<span class="n">c_primal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Constraints need to be in &#39;&lt;=&#39; form for linprog&#39;s A_ub</span>
<span class="c1"># 6*x1 + 8*x2 &lt;= 10</span>
<span class="c1">#  x1 +  x2 &gt;= 1   =&gt;  -x1 - x2 &lt;= -1</span>
<span class="c1">#  x1        &gt;= 1   =&gt;  -x1      &lt;= -1</span>
<span class="n">A_primal_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">b_primal_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Bounds x1 &gt;= 0, x2 &gt;= 0</span>
<span class="n">x_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Solving the Primal Problem ---&quot;</span><span class="p">)</span>
<span class="n">result_primal</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_primal</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_primal_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_primal_ub</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">x_bounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result_primal</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">max_z</span> <span class="o">=</span> <span class="o">-</span><span class="n">result_primal</span><span class="o">.</span><span class="n">fun</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal Value (z) = </span><span class="si">{</span><span class="n">max_z</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An Optimal Solution: (x1, x2) = (</span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Primal problem could not be solved. Message: </span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># --- 2. Formulate and Solve the Dual Problem ---</span>
<span class="c1"># Canonical Primal: Max z = 3x1 + 4x2 s.t.</span>
<span class="c1">#  6x1 + 8x2 &lt;= 10  (y1)</span>
<span class="c1"># -x1 -  x2 &lt;= -1   (y2)</span>
<span class="c1"># -x1 + 0x2 &lt;= -1   (y3)</span>

<span class="c1"># Resulting Dual: Min w = 10y1 - y2 - y3 s.t.</span>
<span class="c1">#  6y1 - y2 - y3 &gt;= 3</span>
<span class="c1">#  8y1 - y2      &gt;= 4</span>
<span class="c1"># y1, y2, y3 &gt;= 0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Solving the Dual Problem ---&quot;</span><span class="p">)</span>
<span class="c1"># Dual objective is minimize</span>
<span class="n">c_dual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Convert dual&#39;s &#39;&gt;=&#39; constraints to &#39;&lt;=&#39; for linprog</span>
<span class="c1">#  6y1 - y2 - y3 &gt;= 3   =&gt;  -6y1 + y2 + y3 &lt;= -3</span>
<span class="c1">#  8y1 - y2      &gt;= 4   =&gt;  -8y1 + y2      &lt;= -4</span>
<span class="n">A_dual_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">b_dual_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Bounds y1, y2, y3 &gt;= 0</span>
<span class="n">y_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>

<span class="n">result_dual</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_dual</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_dual_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_dual_ub</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">y_bounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result_dual</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal Value (w) = </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal Dual Solution (y1, y2, y3):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  y1 = </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  y2 = </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  y3 = </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Primal Problem (Exercise 2.10) ---
Maximize z = 3*x1 + 4*x2
Subject to:
  6*x1 + 8*x2 &lt;= 10
   x1 +  x2 &gt;= 1
   x1        &gt;= 1
   x1, x2 &gt;= 0

--- Solving the Primal Problem ---
Optimal Value (z) = 5.0000
An Optimal Solution: (x1, x2) = (1.0000, 0.5000)

--- Solving the Dual Problem ---
Optimal Value (w) = 5.0000
Optimal Dual Solution (y1, y2, y3):
  y1 = 0.5000
  y2 = 0.0000
  y3 = 0.0000
</pre></div>
</div>
</div>
</div>
<p><strong>2.43</strong></p>
<ul />
<p>Each of the following statements refers to the Simplex algorithm. Fill in the blanks with an appropriate letter from the following choices:</p>
<ol class="arabic simple">
<li><p>If all slack and surplus variables are zero in an optimal solution, then <strong>_______</strong>.</p></li>
<li><p>If a basic variable has the value zero in an optimal solution, then <strong>_______</strong>.</p></li>
<li><p>If an artificial variable is non-zero in an optimal solution, then <strong>_______</strong>.</p></li>
<li><p>If a non-basic variable has zero coefficient in the top row of an optimal tableau, then <strong>_______</strong>.</p></li>
</ol>
<ul />
<p>Completion Alternatives:
A. There are multiple optimal solutions.<br />
B. The current solution is degenerate.<br />
C. All constraints are equalities at optimality.<br />
D. The shadow prices are inverses of the dual variables.<br />
E. No feasible solution exists.<br />
F. The solution is unbounded.</p>
<p><strong>Solution:</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Statement</p></th>
<th class="head"><p>Answer</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1.</strong> If all slack and surplus variables are zero in an optimal solution, then</p></td>
<td><p><strong>C</strong> (All constraints are equalities at optimality)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2.</strong> If a basic variable has the value zero in an optimal solution, then</p></td>
<td><p><strong>B</strong> (The current solution is degenerate)</p></td>
</tr>
<tr class="row-even"><td><p><strong>3.</strong> If an artificial variable is non-zero in an optimal solution, then</p></td>
<td><p><strong>E</strong> (No feasible solution exists)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>4.</strong> If a non-basic variable has zero coefficient in the top row of an optimal tableau, then</p></td>
<td><p><strong>A</strong> (There are multiple optimal solutions)</p></td>
</tr>
</tbody>
</table>
</div>
</ul>
</ul><p><strong>2.44</strong></p>
<ul />
<p>The following statements are intended to describe the relationship between primal and dual linear programming problems. For each statement, fill in the blank to indicate the most appropriate choice from the alternatives shown in the following list.</p>
<ol class="arabic simple">
<li><p>The optimal objective function value in the primal problem corresponds to <strong>_______</strong>.</p></li>
<li><p>The shadow prices in the optimal primal tableau correspond to <strong>_______</strong>.</p></li>
<li><p>Basic variables in the optimal primal tableau correspond to <strong>_______</strong>.</p></li>
<li><p>The variables in the primal problem correspond to <strong>_______</strong>.</p></li>
<li><p>Shadow prices in the optimal dual tableau correspond to <strong>_______</strong>.</p></li>
</ol>
<ul />
<p>Completion Alternatives: <br>
A. The primal non-basic variables <br>
B. The dual non-basic variables <br>
C. The primal constraints <br>
D. Optimal basic variables in the dual problem <br>
E. The optimal objective function value in the dual <br>
F. The shadow prices in the dual <br>
G. Basic variables in the optimal primal problem <br>
H. The constraints in the dual problem <br></p>
<p><strong>Solution:</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Statement</p></th>
<th class="head"><p>Answer</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1.</strong> The optimal objective function value in the primal problem corresponds to</p></td>
<td><p><strong>E</strong> (The optimal objective function value in the dual)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2.</strong> The shadow prices in the optimal primal tableau correspond to</p></td>
<td><p><strong>D</strong> (Optimal basic variables in the dual problem)</p></td>
</tr>
<tr class="row-even"><td><p><strong>3.</strong> Basic variables in the optimal primal tableau correspond to</p></td>
<td><p><strong>B</strong> (The dual non-basic variables)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>4.</strong> The variables in the primal problem correspond to</p></td>
<td><p><strong>H</strong> (The constraints in the dual problem)</p></td>
</tr>
<tr class="row-even"><td><p><strong>5.</strong> Shadow prices in the optimal dual tableau correspond to</p></td>
<td><p><strong>G</strong> (Basic variables in the optimal primal problem)</p></td>
</tr>
</tbody>
</table>
</div>
</ul>
</ul><p><strong>2.45</strong></p>
<ul />
<p>Recall Example 2.8.3 and verify the range within which changes in objective function coefficient <span class="math notranslate nohighlight">\(c_2\)</span> can vary without affecting the optimal solution.</p>
</ul><p><strong>Code Implementation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SimplexSolver</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class to solve standard maximization LPs and store the final state.&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="p">):</span>
        <span class="c1"># Convert inputs to NumPy arrays</span>
        <span class="n">A_ub_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A_ub</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">b_ub_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_ub</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">c_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">c_original</span> <span class="o">=</span> <span class="n">c_np</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span> <span class="o">=</span> <span class="n">A_ub_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span> <span class="o">=</span> <span class="n">A_ub_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_total_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span>

        <span class="c1"># Create tableau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_total_vars</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_np</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A_ub_np</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_total_vars</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b_ub_np</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_decision_vars</span><span class="p">)]</span> <span class="o">+</span> \
                         <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;s</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">)]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;s</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_slack_vars</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs Simplex iterations to find the optimal solution.&quot;&quot;&quot;</span>
        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
            <span class="n">z_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z_row</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">1e-9</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal solution found after </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> iterations.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;Optimal&quot;</span>

            <span class="n">entering_col_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">z_row</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            
            <span class="n">min_ratio</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
            <span class="n">leaving_row_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">constraint_coeffs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">entering_col_idx</span><span class="p">]</span>
            <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constraint_coeffs</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">coeff</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span>
                    <span class="n">ratio</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">coeff</span>
                    <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="n">min_ratio</span><span class="p">:</span>
                        <span class="n">min_ratio</span> <span class="o">=</span> <span class="n">ratio</span>
                        <span class="n">leaving_row_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            
            <span class="k">if</span> <span class="n">leaving_row_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;Unbounded&quot;</span>
            
            <span class="n">pivot_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">leaving_row_idx</span><span class="p">,</span> <span class="n">entering_col_idx</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">leaving_row_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">pivot_element</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">leaving_row_idx</span><span class="p">:</span>
                    <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">entering_col_idx</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="n">factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableau</span><span class="p">[</span><span class="n">leaving_row_idx</span><span class="p">,</span> <span class="p">:]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">[</span><span class="n">leaving_row_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_names</span><span class="p">[</span><span class="n">entering_col_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
            
        <span class="k">return</span> <span class="s2">&quot;Max Iterations Reached&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">analyze_c_range</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">var_name_to_change</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs sensitivity analysis on an objective coefficient.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        solver (SimplexSolver): A solver object that has already found an optimal solution.</span>
<span class="sd">        var_name_to_change (str): The name of the variable whose coefficient we are analyzing (e.g., &#39;x2&#39;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Sensitivity Analysis for Objective Coefficient of </span><span class="si">{</span><span class="n">var_name_to_change</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">var_idx_in_tableau</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var_name_to_change</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">original_c_val</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">c_original</span><span class="p">[</span><span class="n">var_idx_in_tableau</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Variable &#39;</span><span class="si">{</span><span class="n">var_name_to_change</span><span class="si">}</span><span class="s2">&#39; not found in the problem.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">final_tableau</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">tableau</span>
    <span class="n">z_row</span> <span class="o">=</span> <span class="n">final_tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Check if the variable is basic or non-basic in the optimal solution</span>
    <span class="k">if</span> <span class="n">var_name_to_change</span> <span class="ow">in</span> <span class="n">solver</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name_to_change</span><span class="si">}</span><span class="s2"> is a BASIC variable in the optimal solution.&quot;</span><span class="p">)</span>
        
        <span class="c1"># Find the row in the tableau corresponding to this basic variable</span>
        <span class="n">basis_row_idx</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">basis_var_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var_name_to_change</span><span class="p">)</span>
        <span class="n">var_tableau_row</span> <span class="o">=</span> <span class="n">final_tableau</span><span class="p">[</span><span class="n">basis_row_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">non_basic_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">var_names</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">solver</span><span class="o">.</span><span class="n">basis_var_names</span><span class="p">]</span>
        
        <span class="n">lower_bounds_delta</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
        <span class="n">upper_bounds_delta</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Maintaining optimality requires z_j - c_j &gt;= 0 for all non-basic variables.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let Δ be the change in the coefficient c. The new reduced cost is (old z_j-c_j) + Δ * (coeff_j in var_row).&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">nb_idx</span> <span class="ow">in</span> <span class="n">non_basic_indices</span><span class="p">:</span>
            <span class="n">tableau_col_idx</span> <span class="o">=</span> <span class="n">nb_idx</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">reduced_cost</span> <span class="o">=</span> <span class="n">z_row</span><span class="p">[</span><span class="n">tableau_col_idx</span><span class="p">]</span>
            <span class="n">coeff_in_var_row</span> <span class="o">=</span> <span class="n">var_tableau_row</span><span class="p">[</span><span class="n">tableau_col_idx</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff_in_var_row</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span> <span class="c1"># If coefficient is non-zero</span>
                <span class="n">inequality_rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">reduced_cost</span> <span class="o">/</span> <span class="n">coeff_in_var_row</span>
                <span class="k">if</span> <span class="n">coeff_in_var_row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># reduced_cost + Δ * coeff &gt;= 0  =&gt; Δ &gt;= -reduced_cost / coeff</span>
                    <span class="n">lower_bounds_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inequality_rhs</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  For non-basic var </span><span class="si">{</span><span class="n">solver</span><span class="o">.</span><span class="n">var_names</span><span class="p">[</span><span class="n">nb_idx</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">reduced_cost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> + Δ * </span><span class="si">{</span><span class="n">coeff_in_var_row</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &gt;= 0  =&gt;  Δ &gt;= </span><span class="si">{</span><span class="n">inequality_rhs</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># coeff_in_var_row &lt; 0</span>
                    <span class="c1"># reduced_cost + Δ * coeff &gt;= 0  =&gt; Δ &lt;= -reduced_cost / coeff</span>
                    <span class="n">upper_bounds_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inequality_rhs</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  For non-basic var </span><span class="si">{</span><span class="n">solver</span><span class="o">.</span><span class="n">var_names</span><span class="p">[</span><span class="n">nb_idx</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">reduced_cost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> + Δ * </span><span class="si">{</span><span class="n">coeff_in_var_row</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &gt;= 0  =&gt;  Δ &lt;= </span><span class="si">{</span><span class="n">inequality_rhs</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Find the most restrictive bounds on Δ</span>
        <span class="n">min_upper_bound</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">upper_bounds_delta</span><span class="p">)</span>
        <span class="n">max_lower_bound</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lower_bounds_delta</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Combining inequalities gives: </span><span class="si">{</span><span class="n">max_lower_bound</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &lt;= Δ &lt;= </span><span class="si">{</span><span class="n">min_upper_bound</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Calculate the final range for the coefficient c</span>
        <span class="n">lower_c_range</span> <span class="o">=</span> <span class="n">original_c_val</span> <span class="o">+</span> <span class="n">max_lower_bound</span>
        <span class="n">upper_c_range</span> <span class="o">=</span> <span class="n">original_c_val</span> <span class="o">+</span> <span class="n">min_upper_bound</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The original coefficient c2 was </span><span class="si">{</span><span class="n">original_c_val</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The allowable range for c2 is [</span><span class="si">{</span><span class="n">lower_c_range</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">upper_c_range</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Within this range, the optimal solution (x1, x2) = (2, 2) remains the same.&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name_to_change</span><span class="si">}</span><span class="s2"> is a NON-BASIC variable in the optimal solution.&quot;</span><span class="p">)</span>
        <span class="n">reduced_cost</span> <span class="o">=</span> <span class="n">z_row</span><span class="p">[</span><span class="n">var_idx_in_tableau</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The reduced cost (z_j - c_j) for </span><span class="si">{</span><span class="n">var_name_to_change</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">reduced_cost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For the solution to remain optimal, the new reduced cost must be &gt;= 0.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let c_new be the new coefficient. We need z_j - c_new &gt;= 0, so c_new &lt;= z_j.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The coefficient c can be decreased indefinitely. The upper bound is z_j = (old z_j - c_j) + old_c = </span><span class="si">{</span><span class="n">reduced_cost</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">original_c_val</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The allowable range for c2 is (-inf, </span><span class="si">{</span><span class="n">reduced_cost</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">original_c_val</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>


<span class="c1"># --- Problem Definition (Example 2.8.3) ---</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>      <span class="c1"># Objective function coefficients for x1, x2</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>    <span class="c1"># Coefficients for constraint 1</span>
     <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>    <span class="c1"># Coefficients for constraint 2</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>    <span class="c1"># Coefficients for constraint 3</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>   <span class="c1"># RHS for constraints</span>

<span class="c1"># --- 1. Solve the problem to get the optimal tableau ---</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">SimplexSolver</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;Optimal&quot;</span><span class="p">:</span>
    <span class="c1"># --- 2. Perform sensitivity analysis on c2 ---</span>
    <span class="n">analyze_c_range</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">var_name_to_change</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Could not perform sensitivity analysis because the problem status was: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal solution found after 2 iterations.

--- Sensitivity Analysis for Objective Coefficient of x2 ---
x2 is a BASIC variable in the optimal solution.

Maintaining optimality requires z_j - c_j &gt;= 0 for all non-basic variables.
Let Δ be the change in the coefficient c. The new reduced cost is (old z_j-c_j) + Δ * (coeff_j in var_row).
  For non-basic var s1: 2.00 + Δ * 2.00 &gt;= 0  =&gt;  Δ &gt;= -1.00
  For non-basic var s2: 1.00 + Δ * -1.00 &gt;= 0  =&gt;  Δ &lt;= 1.00

Combining inequalities gives: -1.00 &lt;= Δ &lt;= 1.00

The original coefficient c2 was 3.00.
The allowable range for c2 is [2.00, 4.00].
Within this range, the optimal solution (x1, x2) = (2, 2) remains the same.
</pre></div>
</div>
</div>
</div>
<p><strong>2.46</strong></p>
<ul />
<p>What was the theoretical significance of the algorithm developed by Khachiyan for solving linear programming problems?</p>
<p><strong>Solution:</strong></p>
<p>The theoretical significance of the algorithm developed by Leonid Khachiyan in 1979, known as the Ellipsoid Method, was monumental:</p>
<p>It was the first algorithm proven to solve linear programming problems in polynomial time.</p>
<p>This breakthrough proved that linear programming belongs to the complexity class P, meaning problems can be solved “efficiently” in a theoretical sense. Before Khachiyan, the widely used Simplex method had an exponential worst-case time complexity, and it was an open question whether a polynomial-time algorithm for linear programming even existed.</p>
<p>While the Ellipsoid Method was too slow for practical use, its existence resolved a major theoretical question in computer science and optimization.</p>
</ul><p><strong>2.47</strong></p>
<ul />
<p>What is the practical significance of the interior point methods, as originated by Karmarkar, for solving linear programming problems? How do these methods compare in practice with the traditional Simplex-based methods?</p>
<p><strong>Solution:</strong></p>
<p>The practical significance of interior-point methods, introduced by Karmarkar, was that they provided the first computationally efficient polynomial-time algorithm for linear programming. They are often significantly faster than the traditional Simplex method, especially for solving very large-scale problems.</p>
<p>In practice, neither method is universally superior.</p>
<ul />
<p>• Interior-Point: Excels at very large problems solved from scratch by cutting through the interior of the feasible region.<br>
• Simplex: Is often faster for smaller problems and excellent for re-optimization (warm starts) by moving along the edges of the feasible region.</p>
</ul>
<p>Modern solvers include both algorithms and select the most effective one for the specific task.</p>
</ul></section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "MohammadBaniAbdElNabi/Linear-programming",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/Exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Exercises_1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercises (2.1 - 2.15)</p>
      </div>
    </a>
    <a class="right-next"
       href="../References/References.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References and Suggested Readings</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ghaith Rabadi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>